<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>لوحة تحكم المدير - كيس</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #e0f2f1;
      margin: 0;
      padding: 20px;
      direction: rtl;
    }
    h1 {
      color: #00796b;
      text-align: center;
      margin-bottom: 30px;
    }
    form {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 450px;
      margin: 0 auto 40px;
      box-shadow: 0 0 10px #009688aa;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 2px solid #009688;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
    }
    textarea {
      resize: vertical;
      height: 80px;
    }
    button {
      background-color: #009688;
      color: white;
      border: none;
      padding: 15px;
      width: 100%;
      font-size: 18px;
      cursor: pointer;
      border-radius: 6px;
      font-weight: bold;
    }
    .logout-btn {
      display: block;
      max-width: 200px;
      margin: 0 auto 20px;
      padding: 10px;
      background-color: #d32f2f;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      max-width: 900px;
      margin: 0 auto;
      box-shadow: 0 0 10px #009688aa;
    }
    th, td {
      border: 1px solid #009688;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #00796b;
      color: white;
    }
    img.product-img {
      max-width: 80px;
      border-radius: 6px;
    }
    .action-btn {
      background-color: #d32f2f;
      border: none;
      color: white;
      padding: 7px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>لوحة تحكم المدير - بقالة كيس</h1>
<button class="logout-btn" onclick="logout()">تسجيل خروج</button>

<form id="product-form">
  <input type="text" id="name" placeholder="اسم المنتج" required />
  <textarea id="description" placeholder="وصف المنتج (اختياري)"></textarea>
  <input type="number" id="price" placeholder="السعر بالريال" required min="0" />
  <input type="file" id="image" accept="image/*" required />
  <button type="submit">إضافة / تحديث المنتج</button>
</form>

<table id="products-table">
  <thead>
    <tr>
      <th>الصورة</th>
      <th>الاسم</th>
      <th>الوصف</th>
      <th>السعر</th>
      <th>إجراءات</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  // Firebase config - عوض بياناتك هنا
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.firestore();
  const storage = firebase.storage();

  const productForm = document.getElementById('product-form');
  const productsTableBody = document.querySelector('#products-table tbody');

  let editProductId = null;

  // تحقق من تسجيل الدخول
  auth.onAuthStateChanged(user => {
    if (!user) {
      window.location.href = 'login.html';
    } else {
      loadProducts();
    }
  });

  // تسجيل خروج
  function logout() {
    auth.signOut().then(() => {
      window.location.href = 'login.html';
    });
  }

  // تحميل وعرض المنتجات
  function loadProducts() {
    productsTableBody.innerHTML = 'جارٍ تحميل المنتجات...';
    db.collection('products').get().then(snapshot => {
      if (snapshot.empty) {
        productsTableBody.innerHTML = '<tr><td colspan="5">لا توجد منتجات.</td></tr>';
        return;
      }
      productsTableBody.innerHTML = '';
      snapshot.forEach(doc => {
        const product = doc.data();
        const tr = document.createElement('
